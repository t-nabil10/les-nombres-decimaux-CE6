<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>G√©n√©rateur de Plan de Cours</title>
    <script src="https://unpkg.com/docx@7.1.0/build/index.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #4361ee;
            --primary-dark: #3a56d4;
            --secondary: #7209b7;
            --success: #06d6a0;
            --danger: #ef476f;
            --warning: #ffd166;
            --info: #118ab2;
            --light: #f8f9fa;
            --dark: #212529;
            --gray-100: #f8f9fa;
            --gray-200: #e9ecef;
            --gray-300: #dee2e6;
            --gray-400: #ced4da;
            --gray-500: #adb5bd;
            --gray-600: #6c757d;
            --gray-700: #495057;
            --gray-800: #343a40;
            --gray-900: #212529;
            --border-radius: 12px;
            --shadow: 0 8px 30px rgba(0,0,0,0.08);
            --shadow-lg: 0 20px 60px rgba(0,0,0,0.12);
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Inter', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 30px 20px;
            color: var(--gray-800);
            line-height: 1.6;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow-lg);
            overflow: hidden;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        header {
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            color: white;
            padding: 40px 30px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1000 100" fill="%23ffffff" opacity="0.1"><polygon points="1000,100 1000,0 0,100"/></svg>');
            background-size: cover;
        }
        
        h1 {
            font-size: 2.8rem;
            font-weight: 700;
            margin-bottom: 15px;
            position: relative;
            text-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .description {
            font-size: 1.2rem;
            opacity: 0.9;
            font-weight: 400;
            max-width: 600px;
            margin: 0 auto;
            position: relative;
        }
        
        .content {
            padding: 40px;
        }
        
        .form-group {
            margin-bottom: 30px;
        }
        
        label {
            display: block;
            margin-bottom: 12px;
            font-weight: 600;
            font-size: 1.1rem;
            color: var(--gray-800);
        }
        
        input, textarea, select {
            width: 100%;
            padding: 16px 20px;
            border: 2px solid var(--gray-200);
            border-radius: var(--border-radius);
            font-size: 1rem;
            transition: var(--transition);
            background: white;
        }
        
        input:focus, textarea:focus, select:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 4px rgba(67, 97, 238, 0.1);
            transform: translateY(-2px);
        }
        
        textarea {
            min-height: 140px;
            resize: vertical;
            line-height: 1.6;
        }
        
        .exercises-container, .content-container {
            margin-top: 20px;
        }
        
        .exercise-item, .content-item {
            display: flex;
            margin-bottom: 25px;
            align-items: flex-start;
            gap: 15px;
        }
        
        .exercise-item input, .content-item input {
            flex: 1;
            margin: 0;
        }
        
        .content-item.level-1 {
            margin-left: 0;
            padding: 25px;
            background: linear-gradient(135deg, #ffffff 0%, #f8f9ff 100%);
            border-radius: var(--border-radius);
            border-left: 6px solid var(--primary);
            box-shadow: var(--shadow);
            transition: var(--transition);
            border: 1px solid var(--gray-200);
        }

        .content-item.level-1:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-lg);
        }
        
        .content-item.level-2 {
            margin-left: 40px;
            padding: 22px;
            background: linear-gradient(135deg, #ffffff 0%, #f0f4ff 100%);
            border-radius: calc(var(--border-radius) - 2px);
            border-left: 5px solid var(--success);
            box-shadow: 0 4px 20px rgba(0,0,0,0.06);
            border: 1px solid var(--gray-200);
        }
        
        .content-item.level-3 {
            margin-left: 80px;
            padding: 20px;
            background: linear-gradient(135deg, #ffffff 0%, #f8f0ff 100%);
            border-radius: calc(var(--border-radius) - 4px);
            border-left: 4px solid var(--secondary);
            box-shadow: 0 2px 15px rgba(0,0,0,0.04);
            border: 1px solid var(--gray-200);
        }
        
        .btn {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            color: white;
            border: none;
            padding: 14px 24px;
            border-radius: var(--border-radius);
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            transition: var(--transition);
            margin-right: 12px;
            margin-bottom: 12px;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            box-shadow: 0 4px 15px rgba(67, 97, 238, 0.3);
        }
        
        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(67, 97, 238, 0.4);
        }
        
        .btn:active {
            transform: translateY(-1px);
        }
        
        .btn-danger {
            background: linear-gradient(135deg, var(--danger) 0%, #d73654 100%);
            box-shadow: 0 4px 15px rgba(239, 71, 111, 0.3);
        }
        
        .btn-danger:hover {
            box-shadow: 0 8px 25px rgba(239, 71, 111, 0.4);
        }
        
        .btn-secondary {
            background: linear-gradient(135deg, var(--gray-600) 0%, var(--gray-700) 100%);
            box-shadow: 0 4px 15px rgba(108, 117, 125, 0.3);
        }
        
        .btn-secondary:hover {
            box-shadow: 0 8px 25px rgba(108, 117, 125, 0.4);
        }
        
        .btn-success {
            background: linear-gradient(135deg, var(--success) 0%, #05c390 100%);
            box-shadow: 0 4px 15px rgba(6, 214, 160, 0.3);
        }
        
        .btn-success:hover {
            box-shadow: 0 8px 25px rgba(6, 214, 160, 0.4);
        }
        
        .btn-warning {
            background: linear-gradient(135deg, var(--warning) 0%, #ffc747 100%);
            color: var(--gray-800);
            box-shadow: 0 4px 15px rgba(255, 209, 102, 0.3);
        }
        
        .btn-warning:hover {
            box-shadow: 0 8px 25px rgba(255, 209, 102, 0.4);
        }
        
        .btn-latex {
            background: linear-gradient(135deg, #008080 0%, #006666 100%);
            box-shadow: 0 4px 15px rgba(0, 128, 128, 0.3);
        }
        
        .btn-latex:hover {
            box-shadow: 0 8px 25px rgba(0, 128, 128, 0.4);
        }
        
        .export-buttons {
            display: flex;
            gap: 15px;
            margin-top: 30px;
            flex-wrap: wrap;
        }
        
        .btn-export-group {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            flex: 1;
        }
        
        .preview {
            margin-top: 50px;
            border: 2px solid var(--gray-200);
            padding: 35px;
            background: white;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            transition: var(--transition);
        }

        .preview:hover {
            box-shadow: var(--shadow-lg);
        }
        
        .preview h2 {
            margin-bottom: 25px;
            color: var(--primary);
            border-bottom: 3px solid var(--primary);
            padding-bottom: 15px;
            font-size: 1.8rem;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .preview h2::before {
            content: 'üëÅÔ∏è';
            font-size: 1.5rem;
        }
        
        .preview-content {
            font-family: 'Georgia', 'Times New Roman', serif;
            line-height: 1.7;
        }
        
        .preview-title {
            text-align: center;
            font-size: 2.2rem;
            font-weight: 700;
            margin-bottom: 30px;
            color: var(--primary);
            padding: 20px;
            background: linear-gradient(135deg, #f8f9ff 0%, #ffffff 100%);
            border-radius: var(--border-radius);
            border: 2px solid var(--gray-200);
        }
        
        .preview-section {
            margin-bottom: 25px;
        }
        
        .preview-section-title {
            font-weight: 700;
            margin-bottom: 12px;
            font-size: 1.3rem;
            color: var(--primary);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .preview-section-title::before {
            content: '';
            width: 8px;
            height: 8px;
            background: var(--primary);
            border-radius: 50%;
        }
        
        .content-level-1 {
            margin-left: 0;
            font-weight: 600;
            padding: 15px 20px;
            background: linear-gradient(135deg, #e8f4f8 0%, #ffffff 100%);
            border-radius: var(--border-radius);
            margin-bottom: 10px;
            font-size: 1.1rem;
            border-left: 4px solid var(--primary);
            transition: var(--transition);
        }

        .content-level-1:hover {
            transform: translateX(5px);
        }
        
        .content-level-2 {
            margin-left: 25px;
            padding: 12px 18px;
            background: linear-gradient(135deg, #f0f8f0 0%, #ffffff 100%);
            border-radius: calc(var(--border-radius) - 2px);
            margin-bottom: 8px;
            font-size: 1rem;
            border-left: 3px solid var(--success);
        }
        
        .content-level-3 {
            margin-left: 50px;
            font-style: italic;
            padding: 10px 16px;
            background: linear-gradient(135deg, #f5f0f8 0%, #ffffff 100%);
            border-radius: calc(var(--border-radius) - 4px);
            margin-bottom: 6px;
            font-size: 0.95rem;
            border-left: 2px solid var(--secondary);
        }
        
        .duration-input, .date-input {
            width: 150px;
            flex-shrink: 0;
            padding: 14px;
            text-align: center;
        }
        
        .info-line {
            display: flex;
            gap: 30px;
            margin-bottom: 30px;
        }
        
        .info-item {
            flex: 1;
        }
        
        .info-item label {
            margin-bottom: 10px;
            font-size: 1rem;
            color: var(--gray-700);
        }
        
        footer {
            text-align: center;
            padding: 30px;
            font-size: 0.95rem;
            color: var(--gray-600);
            border-top: 2px solid var(--gray-200);
            margin-top: 40px;
            background: var(--gray-100);
        }
        
        .tabs {
            display: flex;
            margin-bottom: 35px;
            border-bottom: 2px solid var(--gray-200);
            background: white;
            border-radius: var(--border-radius) var(--border-radius) 0 0;
            overflow: hidden;
            box-shadow: var(--shadow);
        }
        
        .tab {
            padding: 20px 32px;
            cursor: pointer;
            border-bottom: 4px solid transparent;
            font-size: 1.1rem;
            font-weight: 500;
            transition: var(--transition);
            flex: 1;
            text-align: center;
            background: var(--gray-100);
            color: var(--gray-600);
        }
        
        .tab:hover {
            background: var(--gray-200);
            color: var(--primary);
        }
        
        .tab.active {
            border-bottom: 4px solid var(--primary);
            background: white;
            color: var(--primary);
            font-weight: 600;
        }
        
        .tab-content {
            display: none;
            animation: fadeIn 0.5s ease-in-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .tab-content.active {
            display: block;
        }
        
        .content-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 15px;
        }
        
        .status-message {
            padding: 20px;
            margin-top: 20px;
            border-radius: var(--border-radius);
            text-align: center;
            display: none;
            font-size: 1.1rem;
            font-weight: 500;
            animation: slideIn 0.5s ease-out;
        }

        @keyframes slideIn {
            from { transform: translateY(-20px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        
        .status-success {
            background: linear-gradient(135deg, #d4f7e8 0%, #b8f5df 100%);
            color: #155724;
            border: 2px solid #06d6a0;
        }
        
        .status-error {
            background: linear-gradient(135deg, #fad7de 0%, #f8c6ce 100%);
            color: #721c24;
            border: 2px solid #ef476f;
        }
        
        .sub-content-container {
            width: 100%;
            margin-top: 25px;
        }
        
        .preview-info-line {
            display: flex;
            justify-content: space-between;
            margin-bottom: 30px;
            padding: 25px;
            border-bottom: 2px solid var(--gray-200);
            background: linear-gradient(135deg, #f8f9fa 0%, #ffffff 100%);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
        }
        
        .preview-info-item {
            flex: 1;
            text-align: center;
            padding: 0 20px;
        }
        
        .preview-info-item:not(:last-child) {
            border-right: 2px solid var(--gray-300);
        }
        
        .content-input {
            min-height: 80px;
            padding: 18px;
            font-size: 1.1rem;
            line-height: 1.6;
        }
        
        .content-input::placeholder {
            color: var(--gray-500);
            font-style: italic;
        }
        
        .input-group {
            display: flex;
            align-items: flex-start;
            width: 100%;
            gap: 25px;
        }
        
        .input-content {
            flex: 1;
        }
        
        .input-controls {
            display: flex;
            flex-direction: column;
            gap: 20px;
            min-width: 380px;
        }
        
        .input-row {
            display: flex;
            gap: 20px;
            align-items: center;
        }
        
        .input-row input {
            margin: 0;
        }
        
        /* Styles pour le calendrier */
        .date-picker-container {
            position: relative;
            display: inline-block;
            width: 150px;
        }
        
        .date-input-with-calendar {
            padding-right: 50px !important;
            cursor: pointer;
            background: white;
        }
        
        .calendar-icon {
            position: absolute;
            right: 16px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--primary);
            cursor: pointer;
            font-size: 1.2rem;
            transition: var(--transition);
        }

        .calendar-icon:hover {
            color: var(--primary-dark);
            transform: translateY(-50%) scale(1.1);
        }
        
        .calendar-popup {
            position: absolute;
            top: 100%;
            left: 0;
            background: white;
            border: 2px solid var(--gray-200);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow-lg);
            z-index: 1000;
            padding: 20px;
            min-width: 300px;
            display: none;
            animation: fadeIn 0.3s ease-out;
        }
        
        .calendar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--gray-200);
        }
        
        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 8px;
        }
        
        .calendar-day {
            padding: 12px;
            text-align: center;
            cursor: pointer;
            border-radius: 8px;
            font-size: 0.95rem;
            font-weight: 500;
            transition: var(--transition);
            border: 1px solid transparent;
        }
        
        .calendar-day:hover {
            background: var(--primary);
            color: white;
            transform: scale(1.05);
        }
        
        .calendar-day.selected {
            background: var(--success);
            color: white;
            transform: scale(1.05);
        }
        
        .calendar-day.other-month {
            color: var(--gray-400);
            background: var(--gray-100);
        }
        
        .calendar-nav {
            background: none;
            border: none;
            cursor: pointer;
            padding: 8px;
            font-size: 1.1rem;
            color: var(--primary);
            border-radius: 8px;
            transition: var(--transition);
        }

        .calendar-nav:hover {
            background: var(--gray-200);
            transform: scale(1.1);
        }
        
        .content-with-date {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 0;
        }
        
        .content-text {
            flex: 1;
        }
        
        .content-date {
            margin-left: 20px;
            font-size: 0.9rem;
            color: var(--gray-600);
            font-style: italic;
            min-width: 100px;
            text-align: right;
            background: var(--gray-100);
            padding: 6px 12px;
            border-radius: 20px;
            font-weight: 500;
        }
        
        .hfill-space {
            flex: 1;
            border-bottom: 2px dotted var(--gray-400);
            margin: 0 15px;
            height: 1px;
        }
        
        .font-options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }
        
        .font-option {
            padding: 20px;
            border: 2px solid var(--gray-200);
            border-radius: var(--border-radius);
            cursor: pointer;
            transition: var(--transition);
            background: white;
            text-align: center;
        }
        
        .font-option:hover {
            border-color: var(--primary);
            transform: translateY(-5px);
            box-shadow: var(--shadow);
        }
        
        .font-option.selected {
            border-color: var(--success);
            background: linear-gradient(135deg, #f0f8f0 0%, #ffffff 100%);
            transform: translateY(-5px);
            box-shadow: var(--shadow);
        }
        
        .font-preview {
            font-size: 0.9rem;
            margin-top: 8px;
            color: var(--gray-600);
            font-family: 'Courier New', monospace;
        }
        
        @media print {
            .no-print {
                display: none !important;
            }
            
            .preview {
                border: none;
                box-shadow: none;
                margin: 0;
                padding: 0;
            }
            
            body {
                background: white;
                padding: 0;
            }
            
            .container {
                box-shadow: none;
                margin: 0;
            }
        }

        @media (max-width: 768px) {
            .container {
                margin: 10px;
            }
            
            .content {
                padding: 20px;
            }
            
            .info-line {
                flex-direction: column;
                gap: 15px;
            }
            
            .input-group {
                flex-direction: column;
                gap: 15px;
            }
            
            .input-controls {
                min-width: 100%;
            }
            
            .input-row {
                flex-direction: column;
                gap: 10px;
            }
            
            .duration-input, .date-input {
                width: 100%;
            }
            
            .tabs {
                flex-direction: column;
            }
            
            .export-buttons {
                flex-direction: column;
            }
            
            .btn-export-group {
                flex-direction: column;
            }
        }

        /* Animations suppl√©mentaires */
        .floating {
            animation: floating 3s ease-in-out infinite;
        }

        @keyframes floating {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        .pulse {
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        /* Badges et indicateurs */
        .badge {
            display: inline-flex;
            align-items: center;
            padding: 6px 12px;
            background: var(--primary);
            color: white;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
            margin-left: 10px;
        }

        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }

        .feature-card {
            background: white;
            padding: 25px;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            text-align: center;
            transition: var(--transition);
            border: 2px solid transparent;
        }

        .feature-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-lg);
            border-color: var(--primary);
        }

        .feature-icon {
            font-size: 2.5rem;
            margin-bottom: 15px;
            color: var(--primary);
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1 class="floating">üìö G√©n√©rateur de Plan de Cours</h1>
            <p class="description">Cr√©ez des plans de cours professionnels en quelques clics - Exportez vers Word, Excel, PDF, LaTeX ou imprimez directement</p>
        </header>
        
        <div class="content">
            <div class="tabs no-print">
                <div class="tab active" data-tab="info">
                    <i class="fas fa-info-circle"></i> Informations g√©n√©rales
                </div>
                <div class="tab" data-tab="content">
                    <i class="fas fa-book"></i> Contenu du cours
                </div>
                <div class="tab" data-tab="exercises">
                    <i class="fas fa-tasks"></i> Exercices
                </div>
                <div class="tab" data-tab="latex">
                    <i class="fas fa-code"></i> Options LaTeX
                </div>
            </div>
            
            <div class="tab-content active" id="info-tab">
                <div class="form-group">
                    <label for="courseTitle">
                        <i class="fas fa-graduation-cap"></i> Titre du cours
                        <span class="badge">Requis</span>
                    </label>
                    <input type="text" id="courseTitle" placeholder="Ex: Math√©matiques avanc√©es - Alg√®bre lin√©aire">
                </div>
                
                <div class="info-line">
                    <div class="info-item">
                        <label for="date"><i class="fas fa-calendar"></i> Date de d√©but</label>
                        <input type="text" id="date" placeholder="Ex: 15 septembre 2023">
                    </div>
                    
                    <div class="info-item">
                        <label for="group"><i class="fas fa-users"></i> Groupe</label>
                        <input type="text" id="group" placeholder="Ex: Groupe A, Terminale S">
                    </div>
                    
                    <div class="info-item">
                        <label for="duration"><i class="fas fa-clock"></i> Dur√©e totale</label>
                        <input type="text" id="duration" placeholder="Ex: 12 heures">
                    </div>
                </div>

                <div class="feature-grid">
                    <div class="feature-card">
                        <div class="feature-icon">‚ö°</div>
                        <h3>Rapide</h3>
                        <p>G√©n√©rez vos documents en quelques secondes</p>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon">üé®</div>
                        <h3>Personnalisable</h3>
                        <p>Adaptez le style √† vos besoins</p>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon">üìÅ</div>
                        <h3>Multi-format</h3>
                        <p>Exportez dans tous les formats courants</p>
                    </div>
                </div>
            </div>
            
            <div class="tab-content" id="content-tab">
                <div class="form-group">
                    <label>
                        <i class="fas fa-list-ol"></i> Contenu du cours (avec dates sp√©cifiques)
                        <span class="badge">Structure hi√©rarchique</span>
                    </label>
                    <div class="content-container" id="contentContainer">
                        <!-- Les √©l√©ments de contenu seront ajout√©s ici dynamiquement -->
                    </div>
                    <button type="button" class="btn btn-success pulse" id="addMainContent">
                        <i class="fas fa-plus-circle"></i> Ajouter un point principal
                    </button>
                </div>
            </div>
            
            <div class="tab-content" id="exercises-tab">
                <div class="form-group">
                    <label><i class="fas fa-pencil-alt"></i> Exercices</label>
                    <div class="exercises-container" id="exercisesContainer">
                        <div class="exercise-item">
                            <input type="text" class="exercise" placeholder="Ex: Exercice 1: Calculs alg√©briques - R√©solution d'√©quations">
                            <button type="button" class="btn btn-danger remove-exercise">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </div>
                    <button type="button" class="btn" id="addExercise">
                        <i class="fas fa-plus"></i> Ajouter un exercice
                    </button>
                </div>
            </div>
            
            <div class="tab-content" id="latex-tab">
                <div class="form-group">
                    <label><i class="fas fa-font"></i> Police du titre LaTeX</label>
                    <div class="font-options">
                        <div class="font-option selected" data-font="default">
                            <strong>Computer Modern</strong>
                            <div class="font-preview">Police LaTeX par d√©faut</div>
                        </div>
                        <div class="font-option" data-font="times">
                            <strong>Times New Roman</strong>
                            <div class="font-preview">\usepackage{times}</div>
                        </div>
                        <div class="font-option" data-font="helvet">
                            <strong>Helvetica</strong>
                            <div class="font-preview">\usepackage{helvet}</div>
                        </div>
                        <div class="font-option" data-font="palatino">
                            <strong>Palatino</strong>
                            <div class="font-preview">\usepackage{palatino}</div>
                        </div>
                    </div>
                </div>
                
                <div class="form-group">
                    <label><i class="fas fa-text-height"></i> Taille du titre</label>
                    <select id="titleSize">
                        <option value="Huge">Tr√®s grande (Huge)</option>
                        <option value="huge" selected>Grande (huge)</option>
                        <option value="LARGE">Large (LARGE)</option>
                        <option value="Large">Moyenne (Large)</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label><i class="fas fa-bold"></i> Style du titre</label>
                    <select id="titleStyle">
                        <option value="textbf" selected>Gras (textbf)</option>
                        <option value="textsc">Petites capitales (textsc)</option>
                        <option value="textsl">Italique (textsl)</option>
                        <option value="textnormal">Normal (textnormal)</option>
                    </select>
                </div>
            </div>
            
            <div class="export-buttons no-print">
                <div class="btn-export-group">
                    <button type="button" class="btn btn-success" id="generateWord">
                        <i class="fas fa-file-word"></i> Exporter en Word
                    </button>
                    <button type="button" class="btn btn-success" id="generateExcel">
                        <i class="fas fa-file-excel"></i> Exporter en Excel
                    </button>
                    <button type="button" class="btn btn-danger" id="generatePDF">
                        <i class="fas fa-file-pdf"></i> Exporter en PDF
                    </button>
                    <button type="button" class="btn btn-latex" id="generateLaTeX">
                        <i class="fas fa-code"></i> Exporter en LaTeX
                    </button>
                    <button type="button" class="btn btn-warning" id="printDocument">
                        <i class="fas fa-print"></i> Imprimer
                    </button>
                </div>
            </div>
            
            <div id="statusMessage" class="status-message"></div>
            
            <div class="preview" id="documentPreview">
                <h2><i class="fas fa-eye"></i> Aper√ßu du document</h2>
                <div class="preview-content" id="previewContent">
                    <div class="preview-title" id="previewTitle">Plan du cours</div>
                    
                    <div class="preview-info-line">
                        <div class="preview-info-item">
                            <div class="preview-section-title">Date de d√©but</div>
                            <div id="previewDate">[Date]</div>
                        </div>
                        <div class="preview-info-item">
                            <div class="preview-section-title">Groupe</div>
                            <div id="previewGroup">[Groupe]</div>
                        </div>
                        <div class="preview-info-item">
                            <div class="preview-section-title">Dur√©e totale</div>
                            <div id="previewDuration">[Dur√©e]</div>
                        </div>
                    </div>
                    
                    <div class="preview-section">
                        <div class="preview-section-title">Contenu du cours</div>
                        <div id="previewCourseContent">[Contenu du cours]</div>
                    </div>
                    <div class="preview-section">
                        <div class="preview-section-title">Exercices</div>
                        <div id="previewExercises">[Liste des exercices]</div>
                    </div>
                </div>
            </div>
        </div>
        
        <footer class="no-print">
            <p>üöÄ Application d√©velopp√©e avec passion pour faciliter la cr√©ation de plans de cours professionnels</p>
            <p style="margin-top: 10px; font-size: 0.9rem; opacity: 0.8;">
                <i class="fas fa-heart" style="color: var(--danger);"></i> 
                Supporte tous les formats : Word, Excel, PDF, LaTeX et impression directe
            </p>
        </footer>
    </div>

    <script>
        // Gestion des onglets
        document.querySelectorAll('.tab').forEach(tab => {
            tab.addEventListener('click', () => {
                // D√©sactiver tous les onglets
                document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
                
                // Activer l'onglet s√©lectionn√©
                tab.classList.add('active');
                const tabId = tab.getAttribute('data-tab');
                document.getElementById(`${tabId}-tab`).classList.add('active');
            });
        });

        // Gestion des exercices
        document.getElementById('addExercise').addEventListener('click', () => {
            const container = document.getElementById('exercisesContainer');
            const newExercise = document.createElement('div');
            newExercise.className = 'exercise-item';
            newExercise.innerHTML = `
                <input type="text" class="exercise" placeholder="Ex: Exercice 1: Calculs alg√©briques - R√©solution d'√©quations">
                <button type="button" class="btn btn-danger remove-exercise">
                    <i class="fas fa-trash"></i>
                </button>
            `;
            container.appendChild(newExercise);
            
            // Ajouter l'√©v√©nement de suppression
            newExercise.querySelector('.remove-exercise').addEventListener('click', () => {
                newExercise.remove();
                updatePreview();
            });
            
            // Ajouter l'√©v√©nement de mise √† jour
            newExercise.querySelector('.exercise').addEventListener('input', updatePreview);
            
            updatePreview();
        });

        // Gestion du contenu hi√©rarchique
        document.getElementById('addMainContent').addEventListener('click', () => {
            const container = document.getElementById('contentContainer');
            const newContent = createContentItem(1);
            container.appendChild(newContent);
            updatePreview();
        });

        function createContentItem(level) {
            const item = document.createElement('div');
            item.className = `content-item level-${level}`;
            
            const inputGroup = document.createElement('div');
            inputGroup.className = 'input-group';
            
            const inputContent = document.createElement('div');
            inputContent.className = 'input-content';
            
            const input = document.createElement('input');
            input.type = 'text';
            input.className = 'content-input';
            input.placeholder = `Point de niveau ${level} (ex: Chapitre 1: Introduction)`;
            
            inputContent.appendChild(input);
            
            const inputControls = document.createElement('div');
            inputControls.className = 'input-controls';
            
            const inputRow = document.createElement('div');
            inputRow.className = 'input-row';
            
            const dateInput = document.createElement('input');
            dateInput.type = 'text';
            dateInput.className = 'date-input';
            dateInput.placeholder = 'Date (ex: 15/09)';
            
            const durationInput = document.createElement('input');
            durationInput.type = 'text';
            durationInput.className = 'duration-input';
            durationInput.placeholder = 'Dur√©e (ex: 2h)';
            
            inputRow.appendChild(dateInput);
            inputRow.appendChild(durationInput);
            
            const contentButtons = document.createElement('div');
            contentButtons.className = 'content-buttons';
            
            const addSubButton = document.createElement('button');
            addSubButton.type = 'button';
            addSubButton.className = 'btn btn-secondary';
            addSubButton.innerHTML = '<i class="fas fa-plus-circle"></i> Sous-point';
            
            const removeButton = document.createElement('button');
            removeButton.type = 'button';
            removeButton.className = 'btn btn-danger';
            removeButton.innerHTML = '<i class="fas fa-trash"></i> Supprimer';
            
            contentButtons.appendChild(addSubButton);
            contentButtons.appendChild(removeButton);
            
            inputControls.appendChild(inputRow);
            inputControls.appendChild(contentButtons);
            
            inputGroup.appendChild(inputContent);
            inputGroup.appendChild(inputControls);
            
            item.appendChild(inputGroup);
            
            const subContentContainer = document.createElement('div');
            subContentContainer.className = 'sub-content-container';
            item.appendChild(subContentContainer);
            
            // √âv√©nements
            input.addEventListener('input', updatePreview);
            dateInput.addEventListener('input', updatePreview);
            durationInput.addEventListener('input', updatePreview);
            
            addSubButton.addEventListener('click', () => {
                if (level < 3) {
                    const subItem = createContentItem(level + 1);
                    subContentContainer.appendChild(subItem);
                    updatePreview();
                }
            });
            
            removeButton.addEventListener('click', () => {
                item.remove();
                updatePreview();
            });
            
            return item;
        }

        // Mise √† jour de l'aper√ßu
        function updatePreview() {
            // Titre
            const title = document.getElementById('courseTitle').value || 'Plan du cours';
            document.getElementById('previewTitle').textContent = title;
            
            // Informations g√©n√©rales
            document.getElementById('previewDate').textContent = document.getElementById('date').value || '[Date]';
            document.getElementById('previewGroup').textContent = document.getElementById('group').value || '[Groupe]';
            document.getElementById('previewDuration').textContent = document.getElementById('duration').value || '[Dur√©e]';
            
            // Contenu du cours
            const contentContainer = document.getElementById('contentContainer');
            const contentItems = contentContainer.querySelectorAll('.content-item');
            let contentHTML = '';
            
            contentItems.forEach(item => {
                const level = parseInt(item.className.match(/level-(\d)/)[1]);
                const input = item.querySelector('.content-input');
                const dateInput = item.querySelector('.date-input');
                const durationInput = item.querySelector('.duration-input');
                
                if (input.value) {
                    let dateDuration = '';
                    if (dateInput.value || durationInput.value) {
                        dateDuration = `<span class="content-date">${dateInput.value || ''} ${durationInput.value ? `(${durationInput.value})` : ''}</span>`;
                    }
                    
                    contentHTML += `<div class="content-level-${level}">${input.value}${dateDuration}</div>`;
                    
                    // Sous-contenus
                    const subContainer = item.querySelector('.sub-content-container');
                    if (subContainer) {
                        const subItems = subContainer.querySelectorAll('.content-item');
                        subItems.forEach(subItem => {
                            const subLevel = parseInt(subItem.className.match(/level-(\d)/)[1]);
                            const subInput = subItem.querySelector('.content-input');
                            const subDateInput = subItem.querySelector('.date-input');
                            const subDurationInput = subItem.querySelector('.duration-input');
                            
                            if (subInput.value) {
                                let subDateDuration = '';
                                if (subDateInput.value || subDurationInput.value) {
                                    subDateDuration = `<span class="content-date">${subDateInput.value || ''} ${subDurationInput.value ? `(${subDurationInput.value})` : ''}</span>`;
                                }
                                
                                contentHTML += `<div class="content-level-${subLevel}">${subInput.value}${subDateDuration}</div>`;
                            }
                        });
                    }
                }
            });
            
            document.getElementById('previewCourseContent').innerHTML = contentHTML || '[Contenu du cours]';
            
            // Exercices
            const exercises = document.querySelectorAll('.exercise');
            let exercisesHTML = '';
            
            exercises.forEach(exercise => {
                if (exercise.value) {
                    exercisesHTML += `<div class="content-level-1">${exercise.value}</div>`;
                }
            });
            
            document.getElementById('previewExercises').innerHTML = exercisesHTML || '[Liste des exercices]';
        }

        // Initialiser les √©v√©nements de mise √† jour
        document.getElementById('courseTitle').addEventListener('input', updatePreview);
        document.getElementById('date').addEventListener('input', updatePreview);
        document.getElementById('group').addEventListener('input', updatePreview);
        document.getElementById('duration').addEventListener('input', updatePreview);

        // Initialiser les boutons de suppression d'exercice existants
        document.querySelectorAll('.remove-exercise').forEach(button => {
            button.addEventListener('click', function() {
                this.closest('.exercise-item').remove();
                updatePreview();
            });
        });

        // Initialiser les √©v√©nements d'entr√©e pour les exercices existants
        document.querySelectorAll('.exercise').forEach(input => {
            input.addEventListener('input', updatePreview);
        });

        // Gestion des options de police LaTeX
        document.querySelectorAll('.font-option').forEach(option => {
            option.addEventListener('click', function() {
                document.querySelectorAll('.font-option').forEach(o => o.classList.remove('selected'));
                this.classList.add('selected');
            });
        });

        // Fonctions d'exportation
        document.getElementById('generateWord').addEventListener('click', generateWord);
        document.getElementById('generateExcel').addEventListener('click', generateExcel);
        document.getElementById('generatePDF').addEventListener('click', generatePDF);
        document.getElementById('generateLaTeX').addEventListener('click', generateLaTeX);
        document.getElementById('printDocument').addEventListener('click', printDocument);

        function showStatus(message, type) {
            const status = document.getElementById('statusMessage');
            status.textContent = message;
            status.className = `status-message status-${type}`;
            status.style.display = 'block';
            
            setTimeout(() => {
                status.style.display = 'none';
            }, 5000);
        }

        function generateWord() {
            showStatus('Export Word en cours de d√©veloppement...', 'success');
        }

        function generateExcel() {
            showStatus('Export Excel en cours de d√©veloppement...', 'success');
        }

        function generatePDF() {
            showStatus('Export PDF en cours de d√©veloppement...', 'success');
        }

        function generateLaTeX() {
            const title = document.getElementById('courseTitle').value || 'Plan du cours';
            const date = document.getElementById('date').value || '';
            const group = document.getElementById('group').value || '';
            const duration = document.getElementById('duration').value || '';
            
            // R√©cup√©rer le contenu structur√©
            const contentItems = document.querySelectorAll('.content-item');
            let contentLatex = '';
            
            contentItems.forEach(item => {
                const level = parseInt(item.className.match(/level-(\d)/)[1]);
                const input = item.querySelector('.content-input');
                const dateInput = item.querySelector('.date-input');
                const durationInput = item.querySelector('.duration-input');
                
                if (input.value) {
                    let dateDuration = '';
                    if (dateInput.value || durationInput.value) {
                        dateDuration = ` (${dateInput.value || ''}${dateInput.value && durationInput.value ? ', ' : ''}${durationInput.value || ''})`;
                    }
                    
                    if (level === 1) {
                        contentLatex += `\\section{${input.value}}${dateDuration}\n`;
                    } else if (level === 2) {
                        contentLatex += `\\subsection{${input.value}}${dateDuration}\n`;
                    } else if (level === 3) {
                        contentLatex += `\\subsubsection{${input.value}}${dateDuration}\n`;
                    }
                }
            });
            
            // R√©cup√©rer les exercices
            const exercises = document.querySelectorAll('.exercise');
            let exercisesLatex = '';
            
            exercises.forEach(exercise => {
                if (exercise.value) {
                    exercisesLatex += `\\item ${exercise.value}\n`;
                }
            });
            
            // R√©cup√©rer les options LaTeX
            const selectedFont = document.querySelector('.font-option.selected').getAttribute('data-font');
            const titleSize = document.getElementById('titleSize').value;
            const titleStyle = document.getElementById('titleStyle').value;
            
            // G√©n√©rer le code LaTeX avec le nouveau format
            const latexCode = `\\documentclass[12pt,a4paper]{article}
\\usepackage[utf8]{inputenc}
\\usepackage[T1]{fontenc}
\\usepackage[french]{babel}
\\usepackage{graphicx}
\\usepackage{tcolorbox}
\\usepackage{tabularx}
\\usepackage{geometry}
\\geometry{margin=2cm}

${selectedFont === 'times' ? '\\usepackage{times}' : ''}
${selectedFont === 'helvet' ? '\\usepackage{helvet}' : ''}
${selectedFont === 'palatino' ? '\\usepackage{palatino}' : ''}

\\newcolumntype{Z}{>{\\raggedright\\arraybackslash}X}

\\begin{document}

\\begin{center}
    \\includegraphics[width=.7\\linewidth]{1}
\\end{center}
\\vfill
\\hrule
\\vfill
\\begin{center}
    {\\fontsize{70}{90} \\selectfont\\${titleStyle}{\\${titleSize} ${title}}}
\\end{center}

\\vfill
\\hrule
\\vfill

\\begin{center}
    \\textbf{\\underline{{\\Huge Informations du cours :}}}  \\par\\medskip
\\end{center}

\\begin{tcolorbox}[tabularx={Z|Z|Z}]
    \\textbf{Date de d√©but} & \\textbf{Groupe} & \\textbf{Dur√©e totale} \\\\\\hline\\hline
    ${date} & ${group} & ${duration} \\\\
\\end{tcolorbox}

\\vfill
\\hrule
\\vfill

\\begin{center}
    \\textbf{\\underline{{\\Huge Contenu du cours :}}}  \\par\\medskip
\\end{center}

${contentLatex}

\\vfill
\\hrule
\\vfill

\\begin{center}
    \\textbf{\\underline{{\\Huge Exercices :}}}  \\par\\medskip
\\end{center}

\\begin{itemize}
${exercisesLatex}
\\end{itemize}

\\vfill
\\hrule
\\vfill

\\begin{center}
    \\textbf{{\\Large Ann√©e Scolaire}} : {\\Large \\textbf{2023-2024}}
\\end{center}

\\end{document}`;

            // Cr√©er et t√©l√©charger le fichier
            const blob = new Blob([latexCode], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `${title.replace(/[^a-z0-9]/gi, '_').toLowerCase()}.tex`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            showStatus('Fichier LaTeX g√©n√©r√© avec succ√®s!', 'success');
        }

        function printDocument() {
            window.print();
        }

        // Initialiser l'aper√ßu
        updatePreview();
    </script>
</body>
</html>
